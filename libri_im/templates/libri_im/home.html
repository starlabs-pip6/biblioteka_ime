{% extends 'libri_im/base.html' %} {% load static %} {% block content %}
<!--Links  -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<div class="home-container">
  <div class="welcome">
    <section id="slideshow">
      <div class="entire-content">
          <div class="content-carrousel">
            {% for cBook in cbooks %}
              <figure class="shadow"><img src="{{ cBook.image_link }}"/></figure>
            {% endfor %}
          </div>
      </div>
    </section>

    <!-- qetu punon welcome -->
  </div>
  <div class="sirtariim">
    <!-- qetu punon sirtariim -->
    <div class="title-container">
      <h1 class="text">My shelf</h1>
    </div>
    <div class="sirtariim-container">
      <div class="centerFlex">
        <div class="sirtaret text">
          <div class="nrlibrave-container">
            <p>Want to read</p>
            <p id="wtrtext">{{dtlcount}}</p>
          </div>
          <div class="nrlibrave-container">
            <p>Reading</p>
            <p>{{dlcount}}</p>
          </div>
          <div class="nrlibrave-container">
            <p>Read</p>
            <p>{{klcount}}</p>
          </div>
        </div>
      </div>
        <div class="dukelexuarprogress">
           <div class="profile1 profileFix">
            <img class="profileImg" src="{{ progressBookImage }}" width="200" height="200"alt="noImg">
           </div>
          <div class="title">
            <p>{{progressLibriTitulli}}</p>
          </div>
          <div class="text-progress">
            <p>{{progressNowPages}}/{{progressAllPages}} pages or {{progressPercent}}%</p>
          </div>
          <button class="mybutton updateBtn">Update</button>
      </div>
      <!-- <div class="centerFlex"> -->
      <div class="njoftimet text">
        <div class="njoftimi">
          <p class="njoftimicontent">
            Lirak Rushiti started reading "Harry Potter"...
          </p>
        </div>
        <div class="njoftimi">
          <p class="njoftimicontent">
            Elidon Morina started reading "Harry Potter"...
          </p>
        </div>
        <div class="njoftimi">
          <p class="njoftimicontent">
            Vlera Bllaca started reading "Harry Potter"...
          </p>
        </div>
        <div class="njoftimi">
          <p class="njoftimicontent">
            Sara Bajraktari started reading "Harry Potter"...
          </p>
        </div>
        <div class="njoftimi">
          <p class="njoftimicontent">
            Eris Frangu started reading "Harry Potter"...
          </p>
        </div>
        <div class="njoftimi">
          <p class="njoftimicontent">
            Lirak Rushiti started reading "Harry Potter"...
          </p>
        </div>
        <div class="njoftimi">
          <p class="njoftimicontent">
            Lirak Rushiti started reading "Harry Potter"...
          </p>
        </div>
        <div class="njoftimi">
          <p class="njoftimicontent">
            Lirak Rushiti started reading "Harry Potter"...
          </p>
        </div>
      </div>
      <!-- </div> -->
    </div>
  </div>
  <div class="perty">
    <!-- qetu punon perty -->
    <p class="headingSortby">For you</p>
    <div class="PerTyImages">
      {% for book in booksFY %}
    <div class="mycover ptcover"><a href="{% url 'book-detail' book.isbn %}">
      <img src="{{ book.image_link }}" class="ptimage myimage"></a>
      <h3 class="pttitle">{{book.titulli}}</h3>
      <div class="underlinept"></div>
      <p class="ptdesc">{{book.autori}}</p>
      <button class="mybutton hbpt">Want to read</button>
    </div>
   {% endfor %}
  </div>
  <p  class="meshume"><a href="#" class="a_meshume">More<img class="arrowimage" src="{% static 'libri_im/images/arrow.png' %}"></a></p>
  
  </div>
  <div class="sortby">
    <!-- qetu punon sortby -->
  
    <p class="headingSortby">Latest books</p>
    <div class="sortByImages"> 
      {% for book in booksLatest %}
    <div class="mycover"><a href="{% url 'book-detail' book.isbn %}" >
      <img src="{{ book.image_link}}" class="ptimage myimage"></a>
      {% if book.isbn in wtrBooks %}
      <button onclick="onClickFunction( book='{{ book.isbn }}', wtrBooks = '{{wtrBooks}}');" class=" mybutton hoverbutton linkStyle" id="buttonclick{{book.isbn}}">Added</button>
      {% else %}   
      <button onclick="onClickFunction( book='{{ book.isbn }}', wtrBooks = '{{wtrBooks}}');" class=" mybutton hoverbutton linkStyle" id="buttonclick{{book.isbn}}">Want to read</button>
       {% endif%}
    </div>
    {% endfor %}
   
  </div>  
  <p  class="meshume"><a href="#" class="a_meshume">More<img class="arrowimage" src="{% static 'libri_im/images/arrow.png' %}"></a></p>
  
  <p class="headingSortby">Most rated</p>
  
      
  <div class="sortByImages"> 
    {% csrf_token %}
    {% for book in booksR %}
  <div class="mycover"><a href="{% url 'book-detail' book.isbn %}" >
    <img src="{{ book.image_link}}" class="myimage"></a>
    {% if book.isbn in wtrBooks %}
     <button onclick="onClickFunction( book='{{ book.isbn }}', wtrBooks = '{{wtrBooks}}');" id="buttonclick{{book.isbn}}" class="mybutton hoverbutton linkStyle">Added</button>
    {% else %}
     <button onclick="onClickFunction( book='{{ book.isbn }}', wtrBooks = '{{wtrBooks}}');" id="buttonclick{{book.isbn}}" class="mybutton hoverbutton linkStyle">Want to read</button>
    {% endif%}
  </div>
  {% endfor %}
 
</div>  

  <p  class="meshume"><a href="#" class="a_meshume">More<img class="arrowimage" src="{% static 'libri_im/images/arrow.png' %}"></a></p>


    <p id="p1">Events</p>
  <div class="events">
   <div class="events1 left" >
      <div class="img-container">
        <img src="{% static 'libri_im/images/summerEvent.png' %}" class="img">
      </div>
        <button id="btnEvent">Click here</button>
    </div>
   <div class="events1 right">
    <div class="img-container">
        <img src="{% static 'libri_im/images/YearEvent1.png' %}" class="img">
        </div>
        <button id="btnEvent1">Click here</button>
    </div>
  </div>
  <!-- <script type="text/javascript">
      $(document).on('submit', '#post-form', function(e) {
        e.preventDefault();
        $.ajax({
          type: 'POST',
          url:'/buttontest/' ,
          data: {
              isbn: $('#isbn').val(),
              csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]').val()
          },
          success: function() {

          }
        });
      });
  </script> -->
   <script type="text/javascript"> 

      function onClickFunction(book,wtrBooks){
        btnClickedId = "#buttonclick"+book
          $(document).on('click', btnClickedId, function(e) {
          e.preventDefault();
           });
            $.ajax({
          type: 'POST',
          url:'/buttontest/' ,
          data: {
              isbn: book,
              csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]').val()
          },
          success: function() {
            $.ajax({
              url : "/getdata/wtr",
              type : "GET",
              dataType: "json",
              success: function(json) {
                  $('#wtrtext').text(json.books.length)
                  if( $(btnClickedId).text()==="Want to read"){
                    $(btnClickedId).text("Added")
                  } else {
                    $(btnClickedId).text("Want to read")
                  }
              },
              failure: function(json) { 
                  alert('Got an error dude');
              }
            });    
          
          }
        });
        }
  </script>
</div>
{% endblock content %}
